
@{
    ViewBag.Title = "Overview";

    Random rand = new Random();
}

<div class="row">
    <div class="col-md-12">
        <h2>Resultaten overzicht</h2>
        <hr />
    </div>
</div>

<script>
    function LoadResults(filter, amount) {
        $('#loading_animation').removeClass('hidden');
        $('#btn_loadmore').addClass('disabled');

        $.ajax({
            url: './Results/GetStudies?filter=' + filter,
            type: 'POST',
            success: function (data) {
                $('#loading_animation').addClass('hidden');
                $('#btn_loadmore').removeClass('disabled');
            },
            error: function () {
                $('#table_examinations').append($('#original_row').clone().attr('id', 'row_' + 1).addClass('hidden'));
                //$('#original_loading_error').clone().attr('id', 'loading_error');
                //$('#loading_error').insertAfter($('#button_loadmore'));

                $('#loading_animation').addClass('hidden');
                $('#btn_loadmore').removeClass('disabled');
            }
        });
    }

    $(document).ready(function () {
        $('#btn_loadmore').click(function () {
            LoadResults('', 10);
        });
    });
</script>

<div class="row">
    <div class="col-md-12">
        <table class="table table-hover table-striped">
            <thead>
                <tr>
                    <th></th>
                    <th>Datum en tijd</th>
                    <th>PACS assession</th>
                    <th>Study instance UID</th>
                    <th>Machine</th>
                    <th>Patient ID</th>
                </tr>
            </thead>

            <tbody id="table_examinations"></tbody>
        </table>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <center class="hidden" id="loading_animation">
            <img src="~/Images/loading.gif" height="60px" />
            <br />
            <br />
        </center>

        <div class="btn btn-success btn-lg btn-block" id="btn_loadmore">
            <img src="~/Images/spinner.gif" height="23px" id="loading_animation" class="hidden" /> Meer resultaten laden
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <br />
    </div>
</div>




<!-- The original table to clone for each examination -->
<table class="hidden">
    <tr id="original_row">
        <td></td>
        <td colspan="10" style="padding: 0px" ; margin:0px>
            <table class="table table-hover table-striped" style="margin:0px">
                <thead>
                    <tr>
                        <th>InstanceUID</th>
                        <th>Detector</th>
                        <th>Analysedatum en tijd</th>
                        <th>Status</th>
                        <th>Resultaten</th>
                        <th></th>
                    </tr>
                </thead>

                <tbody></tbody>
            </table>
        </td>
    </tr>
</table>
<!-- End original table -->
<!-- The original loading error -->

<div class="hidden">
    <center id="original_loading_error">
        <div class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
            Er is iets misgegaan tijdens het ophalen van nieuwe resultaten. Controleer uw internetverbinding.
        </div>
    </center>
</div>

<!-- End original loading error-->